{"error":"agentService.getAgentById is not a function","level":"error","message":"Error starting session","service":"chat-support-backend","stack":"TypeError: agentService.getAgentById is not a function\n    at startSession (D:\\chat-support-backend\\src\\controllers\\chatController.js:24:36)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-28 12:57:05","userId":"user1"}
{"error":"agentService.getAgentById is not a function","ip":"::1","level":"error","message":"Error occurred","method":"POST","service":"chat-support-backend","stack":"TypeError: agentService.getAgentById is not a function\n    at startSession (D:\\chat-support-backend\\src\\controllers\\chatController.js:24:36)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-28 12:57:05","url":"/api/chat/start-session","userAgent":"PostmanRuntime/7.44.1"}
{"error":"agentService.getAgentById is not a function","level":"error","message":"Error starting session","service":"chat-support-backend","stack":"TypeError: agentService.getAgentById is not a function\n    at startSession (D:\\chat-support-backend\\src\\controllers\\chatController.js:24:36)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-28 12:57:35","userId":"user123"}
{"error":"agentService.getAgentById is not a function","ip":"::1","level":"error","message":"Error occurred","method":"POST","service":"chat-support-backend","stack":"TypeError: agentService.getAgentById is not a function\n    at startSession (D:\\chat-support-backend\\src\\controllers\\chatController.js:24:36)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-28 12:57:35","url":"/api/chat/start-session","userAgent":"PostmanRuntime/7.44.1"}
{"error":"Session not found","level":"error","message":"Error adding message","senderId":"user123","service":"chat-support-backend","sessionId":":sessionId","timestamp":"2025-08-29 00:10:33"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:5)","timestamp":"2025-08-29 21:42:42"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:5)","timestamp":"2025-08-29 21:43:34"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:5)","timestamp":"2025-08-29 21:44:41"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:5)","timestamp":"2025-08-29 21:59:05"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:25)","timestamp":"2025-08-29 22:00:14"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:25)","timestamp":"2025-08-29 22:00:49"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:25)","timestamp":"2025-08-29 22:02:20"}
{"error":"connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (D:\\chat-support-backend\\node_modules\\mongoose\\lib\\connection.js:791:11)\n    at async connectDatabase (D:\\chat-support-backend\\src\\config\\database.js:13:5)\n    at async startServer (D:\\chat-support-backend\\server.js:132:25)","timestamp":"2025-08-29 22:02:55"}
{"error":"querySrv ENOTFOUND _mongodb._tcp.cluster0.xxxxx.mongodb.net","level":"error","message":"Failed to connect to MongoDB","service":"chat-support-backend","stack":"Error: querySrv ENOTFOUND _mongodb._tcp.cluster0.xxxxx.mongodb.net\n    at QueryReqWrap.onresolve [as oncomplete] (node:internal/dns/promises:293:17)","timestamp":"2025-08-29 22:18:44"}
